<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitExplorer - Exercise Database</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configure Tailwind with custom theme colors for better UI
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',           // Main interaction color
                        'primary-dark': '#4A4BC7',   // Darker shade for hover states
                        'accent': '#10B981',         // Success/positive actions
                        'warning': '#F59E0B',        // Warning states
                        'danger': '#EF4444'          // Error states
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom animations and enhanced styles for better UX */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border-color: #5D5CDE;
        }
        .dark .card-hover:hover {
            box-shadow: 0 25px 50px -12px rgba(93, 92, 222, 0.25);
        }
        
        /* Loading spinner with primary color */
        .loading-spinner {
            border: 4px solid #e5e7eb;
            border-top: 4px solid #5D5CDE;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        /* Smooth animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Enhanced button styles */
        .btn-primary {
            background: linear-gradient(135deg, #5D5CDE 0%, #4A4BC7 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #4A4BC7 0%, #3B3CA0 100%);
            transform: translateY(-1px);
        }
        
        /* Better text visibility in dark mode */
        .text-visible {
            color: #374151;
        }
        .dark .text-visible {
            color: #D1D5DB;
        }
        
        /* Improved filter styles */
        .filter-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 9 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        
        /* Responsive grid improvements */
        .exercise-grid {
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }
        
        /* Better loading state */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        .dark .skeleton {
            background: linear-gradient(90deg, #374151 25%, #4B5563 50%, #374151 75%);
            background-size: 200% 100%;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300 min-h-screen">
    
    <!-- Enhanced header with better gradient and spacing -->
    <header class="bg-gradient-to-r from-primary via-primary-dark to-purple-600 shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <!-- App branding with improved design -->
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-white/90 backdrop-blur rounded-xl flex items-center justify-center shadow-lg">
                        <span class="text-primary font-bold text-2xl">üí™</span>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-white">FitExplorer</h1>
                        <p class="text-white/80 text-sm">Your Exercise Companion</p>
                    </div>
                </div>
                
                <!-- Enhanced control buttons -->
                <div class="flex items-center space-x-6">
                    <!-- How to use button with better styling -->
                    <button onclick="showHowToUse()" 
                            class="flex items-center space-x-2 text-white/90 hover:text-white transition-colors bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg backdrop-blur">
                        <span class="text-lg">‚ÑπÔ∏è</span>
                        <span class="hidden sm:inline text-sm font-medium">How to Use</span>
                    </button>
                    
                    <!-- Enhanced dark mode toggle -->
                    <button onclick="toggleDarkMode()" 
                            class="text-white/90 hover:text-white transition-colors bg-white/10 hover:bg-white/20 p-3 rounded-lg backdrop-blur">
                        <span id="darkModeIcon" class="text-xl">üåô</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Enhanced educational disclaimer -->
    <div class="bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/30 dark:to-orange-900/30 border-l-4 border-amber-400 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex items-start space-x-3">
                <span class="text-amber-600 text-xl">‚ö†Ô∏è</span>
                <div>
                    <p class="text-sm text-amber-800 dark:text-amber-200 font-medium">
                        <strong>Educational Use Only:</strong> This application is designed for educational purposes and fitness exploration.
                    </p>
                    <p class="text-xs text-amber-700 dark:text-amber-300 mt-1">
                        Always consult with a healthcare professional before starting any exercise program. Proper form and safety should be your top priority.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main application container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Enhanced search and filter section -->
        <div class="mb-10 space-y-6">
            <!-- Search bar with improved styling -->
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <span class="text-gray-400 text-xl">üîç</span>
                </div>
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="Search exercises by name, target muscle, equipment, or body part..." 
                    class="w-full pl-12 pr-6 py-4 text-base border-2 border-gray-200 dark:border-gray-600 rounded-2xl focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none bg-white dark:bg-gray-800 shadow-lg transition-all duration-300 text-visible"
                    oninput="filterExercises()"
                >
            </div>

            <!-- Enhanced filter controls with better spacing -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Body part filter -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Body Part</label>
                    <select id="bodyPartFilter" onchange="filterExercises()" 
                            class="w-full px-4 py-3 text-base border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:border-primary focus:outline-none bg-white dark:bg-gray-800 filter-select text-visible">
                        <option value="">All Body Parts</option>
                    </select>
                </div>

                <!-- Equipment filter -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Equipment</label>
                    <select id="equipmentFilter" onchange="filterExercises()" 
                            class="w-full px-4 py-3 text-base border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:border-primary focus:outline-none bg-white dark:bg-gray-800 filter-select text-visible">
                        <option value="">All Equipment</option>
                    </select>
                </div>

                <!-- Target muscle filter -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Target Muscle</label>
                    <select id="targetFilter" onchange="filterExercises()" 
                            class="w-full px-4 py-3 text-base border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:border-primary focus:outline-none bg-white dark:bg-gray-800 filter-select text-visible">
                        <option value="">All Target Muscles</option>
                    </select>
                </div>

                <!-- Sort options -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Sort By</label>
                    <select id="sortSelect" onchange="sortExercises()" 
                            class="w-full px-4 py-3 text-base border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:border-primary focus:outline-none bg-white dark:bg-gray-800 filter-select text-visible">
                        <option value="name">Exercise Name</option>
                        <option value="bodyPart">Body Part</option>
                        <option value="equipment">Equipment Type</option>
                        <option value="target">Target Muscle</option>
                    </select>
                </div>
            </div>

            <!-- Results counter with better visibility -->
            <div class="flex justify-between items-center bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700">
                <span id="resultsCount" class="text-sm font-medium text-gray-600 dark:text-gray-300">Loading exercises...</span>
                <div id="apiStatus" class="text-xs px-3 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400">
                    Connecting to API...
                </div>
            </div>
        </div>

        <!-- Enhanced loading indicator -->
        <div id="loadingIndicator" class="flex flex-col items-center justify-center py-20 space-y-4">
            <div class="loading-spinner"></div>
            <div class="text-center space-y-2">
                <h3 class="text-xl font-semibold text-gray-700 dark:text-gray-300">Loading Exercise Database</h3>
                <p class="text-sm text-gray-500 dark:text-gray-400">Fetching exercises from ExerciseDB API...</p>
            </div>
        </div>

        <!-- Enhanced error message -->
        <div id="errorMessage" class="hidden bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-900/30 dark:to-pink-900/30 border border-red-200 dark:border-red-700 rounded-2xl p-8 text-center shadow-lg">
            <div class="text-6xl mb-4">‚ö†Ô∏è</div>
            <h3 class="text-xl font-bold text-red-600 dark:text-red-400 mb-3">Unable to Load Exercise Database</h3>
            <p class="text-red-500 dark:text-red-300 mb-6 max-w-md mx-auto">
                There was a problem connecting to the ExerciseDB API. This could be due to network issues, API rate limits, or server maintenance.
            </p>
            <div class="space-y-3">
                <button onclick="loadExercises()" 
                        class="inline-flex items-center space-x-2 bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl transition-all duration-300 font-medium">
                    <span>üîÑ</span>
                    <span>Try Again</span>
                </button>
                <p class="text-xs text-red-400 dark:text-red-300">
                    Sample exercises will be shown if API remains unavailable
                </p>
            </div>
        </div>

        <!-- Enhanced exercise grid with better responsiveness -->
        <div id="exerciseGrid" class="exercise-grid grid gap-8 hidden">
            <!-- Exercise cards will be populated here dynamically -->
        </div>
    </div>

    <!-- Enhanced How to Use Modal -->
    <div id="howToUseModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white">How to Use FitExplorer</h2>
                        <p class="text-gray-600 dark:text-gray-400 mt-1">Your guide to exploring exercises effectively</p>
                    </div>
                    <button onclick="hideHowToUse()" 
                            class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-3xl p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">
                        √ó
                    </button>
                </div>
                
                <div class="space-y-6 text-gray-700 dark:text-gray-300">
                    <div class="bg-blue-50 dark:bg-blue-900/30 p-6 rounded-xl border border-blue-200 dark:border-blue-700">
                        <h3 class="font-bold text-xl mb-3 flex items-center space-x-2 text-blue-700 dark:text-blue-300">
                            <span>üîç</span>
                            <span>Search & Filter Exercises</span>
                        </h3>
                        <ul class="space-y-2 text-sm">
                            <li>‚Ä¢ Use the search bar to find exercises by name, target muscle, equipment, or body part</li>
                            <li>‚Ä¢ Apply specific filters to narrow down results by category</li>
                            <li>‚Ä¢ Combine multiple filters for precise exercise selection</li>
                        </ul>
                    </div>
                    
                    <div class="bg-green-50 dark:bg-green-900/30 p-6 rounded-xl border border-green-200 dark:border-green-700">
                        <h3 class="font-bold text-xl mb-3 flex items-center space-x-2 text-green-700 dark:text-green-300">
                            <span>üìã</span>
                            <span>Sort & Organize</span>
                        </h3>
                        <p class="text-sm">Sort exercises alphabetically or by category (body part, equipment, target muscle) for better organization.</p>
                    </div>
                    
                    <div class="bg-purple-50 dark:bg-purple-900/30 p-6 rounded-xl border border-purple-200 dark:border-purple-700">
                        <h3 class="font-bold text-xl mb-3 flex items-center space-x-2 text-purple-700 dark:text-purple-300">
                            <span>üí™</span>
                            <span>Exercise Information</span>
                        </h3>
                        <ul class="space-y-2 text-sm">
                            <li>‚Ä¢ Each card displays exercise name, target muscle, body part, and required equipment</li>
                            <li>‚Ä¢ Click any exercise card to view the demonstration GIF in full size</li>
                            <li>‚Ä¢ Exercise images show proper form and movement patterns</li>
                        </ul>
                    </div>
                    
                    <div class="bg-yellow-50 dark:bg-yellow-900/30 p-6 rounded-xl border border-yellow-200 dark:border-yellow-700">
                        <h3 class="font-bold text-xl mb-3 flex items-center space-x-2 text-yellow-700 dark:text-yellow-300">
                            <span>üåô</span>
                            <span>Personalization</span>
                        </h3>
                        <p class="text-sm">Toggle between light and dark themes using the moon/sun icon in the header for comfortable viewing.</p>
                    </div>
                    
                    <div class="bg-red-50 dark:bg-red-900/30 p-6 rounded-xl border border-red-200 dark:border-red-700">
                        <h3 class="font-bold text-xl mb-3 flex items-center space-x-2 text-red-700 dark:text-red-300">
                            <span>‚ö†Ô∏è</span>
                            <span>Safety & Best Practices</span>
                        </h3>
                        <ul class="space-y-2 text-sm">
                            <li>‚Ä¢ Always warm up before exercising and cool down afterward</li>
                            <li>‚Ä¢ Start with lighter weights and progress gradually</li>
                            <li>‚Ä¢ Focus on proper form over heavy weights</li>
                            <li>‚Ä¢ Consult a fitness professional for personalized guidance</li>
                            <li>‚Ä¢ Listen to your body and rest when needed</li>
                        </ul>
                    </div>
                </div>
                
                <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
                    <p class="text-center text-sm text-gray-500 dark:text-gray-400">
                        FitExplorer uses the ExerciseDB API to provide comprehensive exercise information
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables to store exercise data and application state
        let allExercises = [];           // Store all exercises fetched from the ExerciseDB API
        let filteredExercises = [];     // Store currently filtered/displayed exercises after search/filter operations
        let bodyParts = new Set();      // Unique body parts extracted from API data for filter dropdown
        let equipmentTypes = new Set(); // Unique equipment types extracted from API data for filter dropdown
        let targetMuscles = new Set();  // Unique target muscles extracted from API data for filter dropdown
        let apiConnected = false;       // Boolean flag to track if API connection is successful

        /**
         * Initialize dark mode based on user preference or system setting
         * Checks localStorage first for saved preference, then falls back to system preference
         */
        function initializeDarkMode() {
            const savedTheme = localStorage.getItem('theme');
            const darkModeIcon = document.getElementById('darkModeIcon');
            
            if (savedTheme) {
                // Use saved user preference from previous sessions
                if (savedTheme === 'dark') {
                    document.documentElement.classList.add('dark');
                    darkModeIcon.textContent = '‚òÄÔ∏è';
                }
            } else {
                // Check system preference for initial theme
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                    darkModeIcon.textContent = '‚òÄÔ∏è';
                }
            }
        }

        /**
         * Toggle between dark and light mode
         * Saves user preference to localStorage for persistence across sessions
         */
        function toggleDarkMode() {
            const isDark = document.documentElement.classList.toggle('dark');
            const darkModeIcon = document.getElementById('darkModeIcon');
            
            // Update icon based on current mode
            darkModeIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            // Save preference to localStorage
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        /**
         * Display the how-to-use modal with usage instructions
         * Prevents background scrolling while modal is open
         */
        function showHowToUse() {
            document.getElementById('howToUseModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        /**
         * Hide the how-to-use modal
         * Restores background scrolling functionality
         */
        function hideHowToUse() {
            document.getElementById('howToUseModal').classList.add('hidden');
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        /**
         * Load exercises from the ExerciseDB API
         * This is the main function that fetches real exercise data from the API
         * Uses the provided API credentials to get comprehensive exercise database
         */
        function loadExercises() {
            try {
                // Show loading state and hide other elements for better UX
                document.getElementById('loadingIndicator').classList.remove('hidden');
                document.getElementById('errorMessage').classList.add('hidden');
                document.getElementById('exerciseGrid').classList.add('hidden');
                
                // Update status indicator to show connection attempt
                updateApiStatus('Connecting to ExerciseDB API...', 'loading');
                console.log('üöÄ Initiating API request to ExerciseDB...');

                // Create XMLHttpRequest using the exact format and credentials provided by user
                // This will fetch the complete exercise database with GIF URLs, descriptions, and metadata
                const data = null;
                const xhr = new XMLHttpRequest();
                xhr.withCredentials = true; // Required for RapidAPI CORS handling

                // Set up event listener to handle API response when ready
                xhr.addEventListener('readystatechange', function () {
                    if (this.readyState === this.DONE) {
                        console.log('üì° API Response received with status:', this.status);
                        console.log('üìä Response data length:', this.responseText ? this.responseText.length : 0);
                        
                        // Check if the API request was successful (HTTP 200)
                        if (this.status === 200) {
                            try {
                                console.log('üîç Parsing JSON response from ExerciseDB API...');
                                // Parse the JSON response containing all exercise data
                                const exercises = JSON.parse(this.responseText);
                                console.log('‚úÖ Successfully parsed', exercises.length, 'exercises from API');
                                
                                // Validate the response structure to ensure we got exercise objects
                                // Check for required fields: name, target, bodyPart, equipment
                                if (Array.isArray(exercises) && exercises.length > 0) {
                                    const firstExercise = exercises[0];
                                    console.log('üî¨ First exercise sample:', {
                                        name: firstExercise.name,
                                        target: firstExercise.target,
                                        bodyPart: firstExercise.bodyPart,
                                        equipment: firstExercise.equipment,
                                        hasGifUrl: !!firstExercise.gifUrl,
                                        gifUrl: firstExercise.gifUrl ? firstExercise.gifUrl.substring(0, 50) + '...' : 'No GIF URL'
                                    });
                                    
                                    // Mark API as connected and process the exercise data
                                    apiConnected = true;
                                    updateApiStatus(`Connected - ${exercises.length} exercises loaded`, 'success');
                                    processExerciseData(exercises);
                                } else {
                                    console.warn('‚ùå API returned empty array or invalid format');
                                    console.log('üìù Response preview:', this.responseText.substring(0, 200));
                                    updateApiStatus('Invalid API Response', 'error');
                                    showError();
                                }
                            } catch (parseError) {
                                console.error('‚ùå Error parsing JSON response from API:', parseError);
                                console.log('üìù Raw response preview:', this.responseText.substring(0, 300));
                                updateApiStatus('Response Parse Error', 'error');
                                showError();
                            }
                        } else if (this.status === 429) {
                            // Handle rate limiting specifically
                            console.error('‚è±Ô∏è API rate limit exceeded (429) - Too many requests');
                            updateApiStatus('Rate Limit Exceeded', 'error');
                            showError();
                        } else if (this.status === 401 || this.status === 403) {
                            // Handle authentication errors
                            console.error('üîê API authentication failed:', this.status);
                            console.log('üí° Check API key and subscription status on RapidAPI');
                            updateApiStatus('Authentication Failed', 'error');
                            showError();
                        } else if (this.status === 0) {
                            // Handle network/CORS issues
                            console.error('üåê Network error or CORS issue - Status 0');
                            updateApiStatus('Network Error', 'error');
                            showError();
                        } else {
                            // Handle other HTTP errors
                            console.error('‚ùå API request failed with HTTP status:', this.status);
                            console.error('üìÑ Response text:', this.responseText);
                            updateApiStatus(`HTTP Error ${this.status}`, 'error');
                            showError();
                        }
                    }
                });

                // Configure the API request to fetch all exercises from ExerciseDB
                // Using the main exercises endpoint which returns complete exercise objects with GIF URLs
                console.log('üîó Configuring API request to: https://exercisedb.p.rapidapi.com/exercises');
                xhr.open('GET', 'https://exercisedb.p.rapidapi.com/exercises');
                
                // Set required RapidAPI headers with the provided credentials
                xhr.setRequestHeader('x-rapidapi-key', 'b2ce9ed9bbmsh7872677a1b91630p1514a3jsne25599cd5195');
                xhr.setRequestHeader('x-rapidapi-host', 'exercisedb.p.rapidapi.com');
                console.log('üì§ Sending API request with proper headers...');

                // Send the request to fetch exercise data from ExerciseDB
                xhr.send(data);

            } catch (error) {
                console.error('‚ùå Error initiating API request:', error);
                updateApiStatus('Request Setup Failed', 'error');
                showError();
            }
        }

        /**
         * Process exercise data received from API
         * Extracts unique values for filters and displays exercises
         * @param {Array} exercises - Array of exercise objects from ExerciseDB API
         */
        function processExerciseData(exercises) {
            console.log('‚öôÔ∏è Processing', exercises.length, 'exercises from ExerciseDB API');
            
            // Store exercises in global variables for filtering and searching
            allExercises = exercises;
            filteredExercises = [...exercises]; // Create a copy for filtering operations

            // Extract unique values for filter dropdowns from all exercises
            // This creates sets of unique body parts, equipment types, and target muscles
            exercises.forEach(exercise => {
                if (exercise.bodyPart) bodyParts.add(exercise.bodyPart);
                if (exercise.equipment) equipmentTypes.add(exercise.equipment);
                if (exercise.target) targetMuscles.add(exercise.target);
            });

            console.log('üìä Extracted filter options from API data:', {
                bodyParts: bodyParts.size,
                equipment: equipmentTypes.size,
                targets: targetMuscles.size
            });

            // Populate the filter dropdowns with extracted unique values
            populateFilters();
            
            // Display the exercises in the responsive grid layout
            displayExercises();
            
            // Update UI state - hide loading, show exercise grid
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('exerciseGrid').classList.remove('hidden');
            
            // Update the results counter to show number of exercises loaded
            updateResultsCount();
            
            console.log('‚úÖ Exercise processing completed successfully');
        }

        /**
         * Populate filter dropdown options with unique values from exercises
         * Sorts options alphabetically for better user experience
         */
        function populateFilters() {
            // Populate body parts filter dropdown with sorted options
            const bodyPartFilter = document.getElementById('bodyPartFilter');
            [...bodyParts].sort().forEach(bodyPart => {
                const option = document.createElement('option');
                option.value = bodyPart;
                option.textContent = capitalizeWords(bodyPart);
                bodyPartFilter.appendChild(option);
            });

            // Populate equipment filter dropdown with sorted options
            const equipmentFilter = document.getElementById('equipmentFilter');
            [...equipmentTypes].sort().forEach(equipment => {
                const option = document.createElement('option');
                option.value = equipment;
                option.textContent = capitalizeWords(equipment);
                equipmentFilter.appendChild(option);
            });

            // Populate target muscle filter dropdown with sorted options
            const targetFilter = document.getElementById('targetFilter');
            [...targetMuscles].sort().forEach(target => {
                const option = document.createElement('option');
                option.value = target;
                option.textContent = capitalizeWords(target);
                targetFilter.appendChild(option);
            });
            
            console.log('üéõÔ∏è Filter dropdowns populated with options from API data');
        }

        /**
         * Capitalize the first letter of each word for better display
         * @param {string} str - String to capitalize
         * @returns {string} - Capitalized string
         */
        function capitalizeWords(str) {
            return str.split(' ')
                     .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                     .join(' ');
        }

        /**
         * Filter exercises based on search input and filter selections
         * Applies multiple filters simultaneously for precise results
         */
        function filterExercises() {
            // Get current filter values from the UI elements
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const bodyPartFilter = document.getElementById('bodyPartFilter').value;
            const equipmentFilter = document.getElementById('equipmentFilter').value;
            const targetFilter = document.getElementById('targetFilter').value;

            console.log('üîç Applying filters:', { searchTerm, bodyPartFilter, equipmentFilter, targetFilter });

            // Apply all filters to the complete exercise list from API
            filteredExercises = allExercises.filter(exercise => {
                // Check if search term matches any exercise property (name, target, equipment, bodyPart)
                const matchesSearch = !searchTerm || 
                    exercise.name.toLowerCase().includes(searchTerm) ||
                    exercise.target.toLowerCase().includes(searchTerm) ||
                    exercise.equipment.toLowerCase().includes(searchTerm) ||
                    exercise.bodyPart.toLowerCase().includes(searchTerm);

                // Check if exercise matches selected filters
                const matchesBodyPart = !bodyPartFilter || exercise.bodyPart === bodyPartFilter;
                const matchesEquipment = !equipmentFilter || exercise.equipment === equipmentFilter;
                const matchesTarget = !targetFilter || exercise.target === targetFilter;

                // Exercise must match ALL criteria to be included in results
                return matchesSearch && matchesBodyPart && matchesEquipment && matchesTarget;
            });

            console.log('üìà Filtering result:', filteredExercises.length, 'exercises match criteria');

            // Re-apply current sort after filtering
            sortExercises();
            
            // Update the display with filtered results
            displayExercises();
            updateResultsCount();
        }

        /**
         * Sort exercises based on the selected criteria
         * Maintains sort order when filters are applied
         */
        function sortExercises() {
            const sortBy = document.getElementById('sortSelect').value;
            console.log('üìÇ Sorting exercises by:', sortBy);

            // Sort the filtered exercises array based on selected criteria
            filteredExercises.sort((a, b) => {
                let valueA, valueB;
                
                // Determine what property to sort by
                switch(sortBy) {
                    case 'name':
                        valueA = a.name.toLowerCase();
                        valueB = b.name.toLowerCase();
                        break;
                    case 'bodyPart':
                        valueA = a.bodyPart.toLowerCase();
                        valueB = b.bodyPart.toLowerCase();
                        break;
                    case 'equipment':
                        valueA = a.equipment.toLowerCase();
                        valueB = b.equipment.toLowerCase();
                        break;
                    case 'target':
                        valueA = a.target.toLowerCase();
                        valueB = b.target.toLowerCase();
                        break;
                    default:
                        valueA = a.name.toLowerCase();
                        valueB = b.name.toLowerCase();
                }

                // Perform alphabetical comparison
                return valueA.localeCompare(valueB);
            });

            // Refresh the display with sorted exercises
            displayExercises();
        }

        /**
         * Display exercises in the grid layout
         * Creates exercise cards dynamically for each exercise from API data
         */
        function displayExercises() {
            const grid = document.getElementById('exerciseGrid');
            
            // Clear existing exercise cards
            grid.innerHTML = '';

            console.log('üé® Displaying', filteredExercises.length, 'exercises in responsive grid');

            // Create and append exercise cards for each filtered exercise
            filteredExercises.forEach((exercise, index) => {
                const card = createExerciseCard(exercise, index);
                grid.appendChild(card);
            });
        }

        /**
         * Create an individual exercise card element using comprehensive data from ExerciseDB API
         * @param {Object} exercise - Complete exercise object from ExerciseDB API with all fields
         * @param {number} index - Index for staggered animation delay
         * @returns {HTMLElement} - Enhanced exercise card element with all API data
         */
        function createExerciseCard(exercise, index) {
            const card = document.createElement('div');
            // Add classes for styling, hover effects, and fade-in animations
            card.className = 'bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden card-hover cursor-pointer fade-in border border-gray-200 dark:border-gray-700';
            
            // Add slight delay for staggered animation effect
            card.style.animationDelay = `${index * 0.05}s`;

            // Helper function to get difficulty badge color from API data
            const getDifficultyColor = (difficulty) => {
                switch(difficulty?.toLowerCase()) {
                    case 'beginner': return 'bg-green-500';
                    case 'intermediate': return 'bg-yellow-500';
                    case 'advanced': return 'bg-red-500';
                    default: return 'bg-gray-500';
                }
            };

            // Create the enhanced card HTML content with comprehensive exercise information from API
            card.innerHTML = `
                <!-- Exercise demonstration GIF from ExerciseDB API -->
                <div class="relative bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 h-48">
                    <img 
                        src="${exercise.gifUrl || `https://cdn.jefit.com/assets/img/exercises/gifs/${exercise.id}.gif`}" 
                        alt="${exercise.name} demonstration"
                        class="w-full h-full object-cover transition-transform duration-300 hover:scale-105"
                        loading="lazy"
                        onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PGNpcmNsZSBjeD0iMTUwIiBjeT0iNzAiIHI9IjMwIiBmaWxsPSIjZTVlN2ViIi8+PHJlY3QgeD0iMTIwIiB5PSIxMDAiIHdpZHRoPSI2MCIgaGVpZ2h0PSI0MCIgZmlsbD0iI2U1ZTdlYiIvPjx0ZXh0IHg9IjUwJSIgeT0iMTcwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+RXhlcmNpc2UgRGVtbzwvdGV4dD48L3N2Zz4='; this.classList.add('opacity-75');"
                    >
                    <!-- Multiple badges with exercise metadata from API -->
                    <div class="absolute top-3 right-3 flex flex-col gap-2">
                        <!-- Body part badge -->
                        <div class="bg-primary/90 text-white px-3 py-1 rounded-full text-xs font-medium backdrop-blur">
                            ${capitalizeWords(exercise.bodyPart)}
                        </div>
                        <!-- Difficulty level badge from API -->
                        ${exercise.difficulty ? `
                        <div class="${getDifficultyColor(exercise.difficulty)} text-white px-3 py-1 rounded-full text-xs font-medium backdrop-blur">
                            ${capitalizeWords(exercise.difficulty)}
                        </div>
                        ` : ''}
                    </div>
                    <!-- Category badge from API -->
                    ${exercise.category ? `
                    <div class="absolute top-3 left-3 bg-black/60 text-white px-3 py-1 rounded-full text-xs font-medium backdrop-blur">
                        ${capitalizeWords(exercise.category)}
                    </div>
                    ` : ''}
                </div>
                
                <!-- Enhanced exercise information section with all API data -->
                <div class="p-6">
                    <!-- Exercise name as card title -->
                    <h3 class="font-bold text-xl mb-3 text-gray-900 dark:text-white leading-tight">
                        ${capitalizeWords(exercise.name)}
                    </h3>
                    
                    <!-- Exercise description preview from API -->
                    ${exercise.description ? `
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2">
                        ${exercise.description.substring(0, 120)}${exercise.description.length > 120 ? '...' : ''}
                    </p>
                    ` : ''}
                    
                    <!-- Enhanced exercise details grid with all API information -->
                    <div class="space-y-3 text-sm">
                        <!-- Primary target muscle information from API -->
                        <div class="flex items-center justify-between p-3 bg-primary/5 dark:bg-primary/10 rounded-lg">
                            <span class="text-gray-600 dark:text-gray-400 font-medium">Primary Target:</span>
                            <span class="font-semibold bg-primary text-white px-3 py-1 rounded-full text-xs">
                                ${capitalizeWords(exercise.target)}
                            </span>
                        </div>
                        
                        <!-- Secondary muscles from API (if available) -->
                        ${exercise.secondaryMuscles && exercise.secondaryMuscles.length > 0 ? `
                        <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                            <span class="text-gray-600 dark:text-gray-400 font-medium text-xs block mb-2">Secondary Muscles:</span>
                            <div class="flex flex-wrap gap-1">
                                ${exercise.secondaryMuscles.slice(0, 3).map(muscle => 
                                    `<span class="text-xs bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full">${capitalizeWords(muscle)}</span>`
                                ).join('')}
                                ${exercise.secondaryMuscles.length > 3 ? `<span class="text-xs text-blue-600 dark:text-blue-400">+${exercise.secondaryMuscles.length - 3} more</span>` : ''}
                            </div>
                        </div>
                        ` : ''}
                        
                        <!-- Equipment and body part information from API -->
                        <div class="grid grid-cols-2 gap-3">
                            <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg text-center">
                                <span class="text-gray-600 dark:text-gray-400 font-medium text-xs block">Equipment</span>
                                <span class="font-semibold text-gray-800 dark:text-gray-200 text-sm">
                                    ${capitalizeWords(exercise.equipment)}
                                </span>
                            </div>
                            <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg text-center">
                                <span class="text-gray-600 dark:text-gray-400 font-medium text-xs block">Body Part</span>
                                <span class="font-semibold text-gray-800 dark:text-gray-200 text-sm">
                                    ${capitalizeWords(exercise.bodyPart)}
                                </span>
                            </div>
                        </div>
                        
                        <!-- Instructions preview from API -->
                        ${exercise.instructions && exercise.instructions.length > 0 ? `
                        <div class="p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg">
                            <span class="text-gray-600 dark:text-gray-400 font-medium text-xs block mb-2">Quick Steps:</span>
                            <div class="text-xs text-amber-700 dark:text-amber-300">
                                ${exercise.instructions.slice(0, 2).map((instruction, i) => 
                                    `<div class="mb-1">${i + 1}. ${instruction.substring(0, 80)}${instruction.length > 80 ? '...' : ''}</div>`
                                ).join('')}
                                ${exercise.instructions.length > 2 ? `<div class="text-amber-600 dark:text-amber-400 font-medium">+${exercise.instructions.length - 2} more steps...</div>` : ''}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <!-- Enhanced action button -->
                    <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-600">
                        <button class="w-full btn-primary text-white py-3 px-6 rounded-xl font-semibold flex items-center justify-center space-x-2 shadow-lg">
                            <span>üìã</span>
                            <span>View Full Instructions & Demo</span>
                        </button>
                    </div>
                </div>
            `;

            // Add click handler to show comprehensive exercise details with all API data
            card.addEventListener('click', () => showExerciseDetails(exercise));

            return card;
        }

        /**
         * Show comprehensive exercise information in a modal using all ExerciseDB API data
         * @param {Object} exercise - Complete exercise object from API with instructions, description, difficulty, etc.
         */
        function showExerciseDetails(exercise) {
            // Create modal overlay
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4';
            
            // Helper function to get difficulty badge color from API data
            const getDifficultyColor = (difficulty) => {
                switch(difficulty?.toLowerCase()) {
                    case 'beginner': return 'bg-green-500 text-white';
                    case 'intermediate': return 'bg-yellow-500 text-white';
                    case 'advanced': return 'bg-red-500 text-white';
                    default: return 'bg-gray-500 text-white';
                }
            };

            // Create comprehensive modal content with all exercise details from ExerciseDB API
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-8">
                        <!-- Enhanced modal header with exercise metadata from API -->
                        <div class="flex justify-between items-start mb-6">
                            <div class="flex-1">
                                <div class="flex items-center gap-4 mb-3">
                                    <h2 class="text-3xl font-bold text-gray-900 dark:text-white">
                                        ${capitalizeWords(exercise.name)}
                                    </h2>
                                    <!-- Difficulty and category badges from API -->
                                    <div class="flex gap-2">
                                        ${exercise.difficulty ? `
                                        <span class="${getDifficultyColor(exercise.difficulty)} px-3 py-1 rounded-full text-sm font-medium">
                                            ${capitalizeWords(exercise.difficulty)}
                                        </span>
                                        ` : ''}
                                        ${exercise.category ? `
                                        <span class="bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-medium">
                                            ${capitalizeWords(exercise.category)}
                                        </span>
                                        ` : ''}
                                    </div>
                                </div>
                                <p class="text-gray-600 dark:text-gray-400">Complete Exercise Guide from ExerciseDB API</p>
                            </div>
                            <button onclick="this.closest('.fixed').remove(); document.body.style.overflow = 'auto';" 
                                    class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-3xl p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors ml-4">
                                √ó
                            </button>
                        </div>
                        
                        <!-- Exercise description from API (if available) -->
                        ${exercise.description ? `
                        <div class="mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-2xl border border-blue-200 dark:border-blue-700">
                            <h3 class="font-bold text-lg mb-3 text-blue-800 dark:text-blue-300 flex items-center space-x-2">
                                <span>üìã</span>
                                <span>Exercise Description</span>
                            </h3>
                            <p class="text-blue-700 dark:text-blue-300 leading-relaxed">
                                ${exercise.description}
                            </p>
                        </div>
                        ` : ''}
                        
                        <!-- Main content grid -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Left column: Exercise demonstration and basic info -->
                            <div class="space-y-6">
                                <!-- Exercise demonstration GIF from ExerciseDB API -->
                                <div class="bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-2xl overflow-hidden p-4">
                                    <img src="${exercise.gifUrl || `https://cdn.jefit.com/assets/img/exercises/gifs/${exercise.id}.gif`}" 
                                         alt="${exercise.name} demonstration" 
                                         class="w-full h-auto rounded-xl shadow-lg mx-auto"
                                         style="max-height: 400px; object-fit: contain;"
                                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTAwIiByPSI0MCIgZmlsbD0iI2U1ZTdlYiIvPjxyZWN0IHg9IjE2MCIgeT0iMTQwIiB3aWR0aD0iODAiIGhlaWdodD0iNjAiIGZpbGw9IiNlNWU3ZWIiLz48dGV4dCB4PSI1MCUiIHk9IjI0MCIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkV4ZXJjaXNlIERlbW9uc3RyYXRpb248L3RleHQ+PC9zdmc+'; this.classList.add('opacity-75');">
                                </div>
                                
                                <!-- Exercise metadata grid using comprehensive API data -->
                                <div class="grid grid-cols-2 gap-4">
                                    <!-- Primary target muscle from API -->
                                    <div class="bg-gradient-to-br from-primary/10 to-primary/5 dark:from-primary/20 dark:to-primary/10 p-4 rounded-xl text-center border border-primary/20">
                                        <div class="text-2xl mb-2">üéØ</div>
                                        <div class="font-bold text-gray-900 dark:text-white text-sm">Primary Target</div>
                                        <div class="text-primary font-semibold mt-1">${capitalizeWords(exercise.target)}</div>
                                    </div>
                                    
                                    <!-- Body part from API -->
                                    <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-xl text-center border border-green-200 dark:border-green-700">
                                        <div class="text-2xl mb-2">üí™</div>
                                        <div class="font-bold text-gray-900 dark:text-white text-sm">Body Part</div>
                                        <div class="text-green-700 dark:text-green-400 font-semibold mt-1">${capitalizeWords(exercise.bodyPart)}</div>
                                    </div>
                                    
                                    <!-- Equipment from API -->
                                    <div class="bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 p-4 rounded-xl text-center border border-orange-200 dark:border-orange-700">
                                        <div class="text-2xl mb-2">üèãÔ∏è</div>
                                        <div class="font-bold text-gray-900 dark:text-white text-sm">Equipment</div>
                                        <div class="text-orange-700 dark:text-orange-400 font-semibold mt-1">${capitalizeWords(exercise.equipment)}</div>
                                    </div>
                                    
                                    <!-- Exercise ID from API -->
                                    <div class="bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-700 dark:to-slate-700 p-4 rounded-xl text-center border border-gray-200 dark:border-gray-600">
                                        <div class="text-2xl mb-2">üî¢</div>
                                        <div class="font-bold text-gray-900 dark:text-white text-sm">Exercise ID</div>
                                        <div class="text-gray-700 dark:text-gray-300 font-semibold mt-1">${exercise.id}</div>
                                    </div>
                                </div>
                                
                                <!-- Secondary muscles from API (if available) -->
                                ${exercise.secondaryMuscles && exercise.secondaryMuscles.length > 0 ? `
                                <div class="p-6 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl border border-purple-200 dark:border-purple-700">
                                    <h3 class="font-bold text-lg mb-3 text-purple-800 dark:text-purple-300 flex items-center space-x-2">
                                        <span>üîó</span>
                                        <span>Secondary Muscles Worked</span>
                                    </h3>
                                    <div class="flex flex-wrap gap-2">
                                        ${exercise.secondaryMuscles.map(muscle => 
                                            `<span class="bg-purple-100 dark:bg-purple-800 text-purple-700 dark:text-purple-300 px-3 py-1 rounded-full text-sm font-medium">${capitalizeWords(muscle)}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                            
                            <!-- Right column: Detailed instructions and information -->
                            <div class="space-y-6">
                                <!-- Step-by-step instructions from API -->
                                ${exercise.instructions && exercise.instructions.length > 0 ? `
                                <div class="p-6 bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 rounded-xl border border-amber-200 dark:border-amber-700">
                                    <h3 class="font-bold text-xl mb-4 text-amber-800 dark:text-amber-300 flex items-center space-x-2">
                                        <span>üìù</span>
                                        <span>Step-by-Step Instructions</span>
                                    </h3>
                                    <div class="space-y-4">
                                        ${exercise.instructions.map((instruction, index) => `
                                            <div class="flex items-start space-x-3 p-3 bg-white/70 dark:bg-gray-800/70 rounded-lg">
                                                <div class="flex-shrink-0 w-6 h-6 bg-amber-500 text-white rounded-full flex items-center justify-center text-sm font-bold">
                                                    ${index + 1}
                                                </div>
                                                <p class="text-amber-800 dark:text-amber-200 leading-relaxed">
                                                    ${instruction}
                                                </p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                ` : `
                                <div class="p-6 bg-gradient-to-r from-gray-50 to-slate-50 dark:from-gray-700 dark:to-slate-700 rounded-xl border border-gray-200 dark:border-gray-600">
                                    <h3 class="font-bold text-lg mb-3 text-gray-700 dark:text-gray-300 flex items-center space-x-2">
                                        <span>üìù</span>
                                        <span>Instructions</span>
                                    </h3>
                                    <p class="text-gray-600 dark:text-gray-400 italic">
                                        Detailed instructions not available for this exercise from the API. Please consult a fitness professional for proper form guidance.
                                    </p>
                                </div>
                                `}
                                
                                <!-- Safety tips and best practices -->
                                <div class="p-6 bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-900/20 dark:to-pink-900/20 rounded-xl border border-red-200 dark:border-red-700">
                                    <h3 class="font-bold text-lg mb-4 text-red-800 dark:text-red-300 flex items-center space-x-2">
                                        <span>‚ö†Ô∏è</span>
                                        <span>Safety Guidelines & Tips</span>
                                    </h3>
                                    <ul class="space-y-2 text-sm text-red-700 dark:text-red-300">
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Always warm up before exercising and cool down afterward</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Focus on proper form over heavy weights or fast repetitions</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Start with lighter resistance and gradually progress</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Breathe consistently throughout the movement</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Stop immediately if you experience pain or discomfort</span>
                                        </li>
                                        <li class="flex items-start space-x-2">
                                            <span class="text-red-500 mt-1">‚Ä¢</span>
                                            <span>Consult a fitness professional for personalized guidance</span>
                                        </li>
                                    </ul>
                                </div>
                                
                                <!-- Additional exercise information -->
                                <div class="p-6 bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 rounded-xl border border-indigo-200 dark:border-indigo-700">
                                    <h3 class="font-bold text-lg mb-3 text-indigo-800 dark:text-indigo-300 flex items-center space-x-2">
                                        <span>üí°</span>
                                        <span>Exercise Information</span>
                                    </h3>
                                    <div class="grid grid-cols-1 gap-3 text-sm">
                                        ${exercise.difficulty ? `
                                        <div class="flex justify-between items-center p-2 bg-white/50 dark:bg-gray-800/50 rounded">
                                            <span class="text-indigo-700 dark:text-indigo-300 font-medium">Difficulty Level:</span>
                                            <span class="font-semibold text-indigo-800 dark:text-indigo-200">${capitalizeWords(exercise.difficulty)}</span>
                                        </div>
                                        ` : ''}
                                        ${exercise.category ? `
                                        <div class="flex justify-between items-center p-2 bg-white/50 dark:bg-gray-800/50 rounded">
                                            <span class="text-indigo-700 dark:text-indigo-300 font-medium">Exercise Category:</span>
                                            <span class="font-semibold text-indigo-800 dark:text-indigo-200">${capitalizeWords(exercise.category)}</span>
                                        </div>
                                        ` : ''}
                                        <div class="flex justify-between items-center p-2 bg-white/50 dark:bg-gray-800/50 rounded">
                                            <span class="text-indigo-700 dark:text-indigo-300 font-medium">Data Source:</span>
                                            <span class="font-semibold text-indigo-800 dark:text-indigo-200">ExerciseDB API</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal to page and prevent background scrolling
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        /**
         * Update the results counter display
         * Shows how many exercises are currently visible vs total from API
         */
        function updateResultsCount() {
            const count = filteredExercises.length;
            const total = allExercises.length;
            const countElement = document.getElementById('resultsCount');
            
            if (count === total) {
                countElement.textContent = `Showing all ${total} exercises from ExerciseDB`;
            } else {
                countElement.textContent = `Showing ${count} of ${total} exercises from ExerciseDB`;
            }
            
            // Add additional context if no results found
            if (count === 0 && total > 0) {
                countElement.innerHTML = `<span class="text-orange-600">No exercises match your search criteria</span>`;
            }
        }

        /**
         * Update API connection status indicator
         * @param {string} message - Status message to display
         * @param {string} type - Status type (loading, success, error)
         */
        function updateApiStatus(message, type) {
            const statusElement = document.getElementById('apiStatus');
            statusElement.textContent = message;
            
            // Remove existing status classes
            statusElement.classList.remove('bg-green-100', 'text-green-600', 'bg-red-100', 'text-red-600', 'bg-yellow-100', 'text-yellow-600');
            statusElement.classList.remove('dark:bg-green-900', 'dark:text-green-400', 'dark:bg-red-900', 'dark:text-red-400', 'dark:bg-yellow-900', 'dark:text-yellow-400');
            
            // Apply status-specific styling
            switch(type) {
                case 'success':
                    statusElement.classList.add('bg-green-100', 'text-green-600', 'dark:bg-green-900', 'dark:text-green-400');
                    break;
                case 'error':
                    statusElement.classList.add('bg-red-100', 'text-red-600', 'dark:bg-red-900', 'dark:text-red-400');
                    break;
                case 'loading':
                default:
                    statusElement.classList.add('bg-yellow-100', 'text-yellow-600', 'dark:bg-yellow-900', 'dark:text-yellow-400');
                    break;
            }
        }

        /**
         * Show error message and attempt to load sample data as fallback
         * Provides graceful degradation when ExerciseDB API is unavailable
         */
        function showError() {
            // Hide loading indicator and show error message
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('errorMessage').classList.remove('hidden');
            document.getElementById('exerciseGrid').classList.add('hidden');
            
            // Attempt to load sample data after a short delay as fallback
            console.log('‚ö†Ô∏è ExerciseDB API failed, will load sample data as fallback...');
            setTimeout(() => {
                loadSampleData();
            }, 2000);
        }

        /**
         * Load sample exercise data as fallback when ExerciseDB API is unavailable
         * Provides offline functionality with demonstration exercises
         * This is only used when the real API fails
         */
        function loadSampleData() {
            console.log('üì¶ Loading sample exercise data for demonstration (API fallback)...');
            
            // Hide error message
            document.getElementById('errorMessage').classList.add('hidden');
            
            // Update status and results counter to indicate sample data
            updateApiStatus('Using Sample Data (API Offline)', 'error');
            const resultsCount = document.getElementById('resultsCount');
            resultsCount.innerHTML = `<span class="text-orange-600 font-medium">‚ö†Ô∏è Showing sample data - ExerciseDB API connection failed</span>`;
            
            // Sample exercises with placeholder images for demonstration
            // These represent the structure of real ExerciseDB API data
            const sampleExercises = [
                {
                    id: "sample_0001",
                    name: "3/4 sit-up",
                    target: "abs",
                    bodyPart: "waist",
                    equipment: "body weight",
                    gifUrl: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmM2Y0ZjYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU3ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2EpIi8+PGNpcmNsZSBjeD0iMTUwIiBjeT0iNzAiIHI9IjI1IiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTI1IiB5PSI5NSIgd2lkdGg9IjUwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTM1IiB5PSIxMjUiIHdpZHRoPSIzMCIgaGVpZ2h0PSI0MCIgZmlsbD0iI2QxZDVkYiIvPjx0ZXh0IHg9IjUwJSIgeT0iMTgwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+U2FtcGxlOiBTaXQtdXA8L3RleHQ+PC9zdmc+"
                },
                {
                    id: "sample_0002", 
                    name: "45¬∞ side bend",
                    target: "abs",
                    bodyPart: "waist",
                    equipment: "body weight",
                    gifUrl: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmM2Y0ZjYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU3ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2IpIi8+PGNpcmNsZSBjeD0iMTQwIiBjeT0iNjAiIHI9IjI1IiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTIwIiB5PSI4NSIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjZDFkNWRiIiB0cmFuc2Zvcm09InJvdGF0ZSgxNSAxNDAgMTA1KSIvPjxyZWN0IHg9IjEzMCIgeT0iMTI1IiB3aWR0aD0iMjAiIGhlaWdodD0iNDAiIGZpbGw9IiNkMWQ1ZGIiLz48dGV4dCB4PSI1MCUiIHk9IjE4MCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlNhbXBsZTogU2lkZSBCZW5kPC90ZXh0Pjwvc3ZnPg=="
                },
                {
                    id: "sample_0003",
                    name: "air bike",
                    target: "abs",
                    bodyPart: "waist", 
                    equipment: "body weight",
                    gifUrl: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImMiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmM2Y0ZjYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU3ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2MpIi8+PGNpcmNsZSBjeD0iMTUwIiBjeT0iNTAiIHI9IjIwIiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTMwIiB5PSI3MCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjZDFkNWRiIi8+PGVsbGlwc2UgY3g9IjEyMCIgY3k9IjEyMCIgcng9IjE1IiByeT0iMjUiIGZpbGw9IiNkMWQ1ZGIiLz48ZWxsaXBzZSBjeD0iMTgwIiBjeT0iMTEwIiByeD0iMTUiIHJ5PSIyNSIgZmlsbD0iI2QxZDVkYiIvPjx0ZXh0IHg9IjUwJSIgeT0iMTgwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+U2FtcGxlOiBBaXIgQmlrZTwvdGV4dD48L3N2Zz4="
                },
                {
                    id: "sample_0004",
                    name: "barbell bench press",
                    target: "pectorals",
                    bodyPart: "chest",
                    equipment: "barbell",
                    gifUrl: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmM2Y0ZjYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU3ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2QpIi8+PGNpcmNsZSBjeD0iMTUwIiBjeT0iNDAiIHI9IjIwIiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTMwIiB5PSI2MCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iODAiIHk9Ijc1IiB3aWR0aD0iMTQwIiBoZWlnaHQ9IjEwIiBmaWxsPSIjOTljYTNhZiIgcng9IjUiLz48Y2lyY2xlIGN4PSI2NSIgY3k9IjgwIiByPSIxNSIgZmlsbD0iIzZiNzI4MCIvPjxjaXJjbGUgY3g9IjIzNSIgY3k9IjgwIiByPSIxNSIgZmlsbD0iIzZiNzI4MCIvPjxyZWN0IHg9IjEzNSIgeT0iMTAwIiB3aWR0aD0iMzAiIGhlaWdodD0iNDAiIGZpbGw9IiNkMWQ1ZGIiLz48dGV4dCB4PSI1MCUiIHk9IjE4MCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlNhbXBsZTogQmVuY2ggUHJlc3M8L3RleHQ+PC9zdmc+"
                },
                {
                    id: "sample_0005",
                    name: "dumbbell bicep curl",
                    target: "biceps",
                    bodyPart: "upper arms",
                    equipment: "dumbbell",
                    gifUrl: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImUiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmM2Y0ZjYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWU3ZWIiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2UpIi8+PGNpcmNsZSBjeD0iMTUwIiBjeT0iNDAiIHI9IjIwIiBmaWxsPSIjZDFkNWRiIi8+PHJlY3QgeD0iMTMwIiB5PSI2MCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjZDFkNWRiIi8+PGVsbGlwc2UgY3g9IjEyMCIgY3k9IjEwMCIgcng9IjEwIiByeT0iMzAiIGZpbGw9IiNkMWQ1ZGIiLz48ZWxsaXBzZSBjeD0iMTgwIiBjeT0iMTAwIiByeD0iMTAiIHJ5PSIzMCIgZmlsbD0iI2QxZDVkYiIvPjxyZWN0IHg9IjEwNSIgeT0iODUiIHdpZHRoPSIzMCIgaGVpZ2h0PSIxMCIgZmlsbD0iIzZiNzI4MCIgcng9IjUiLz48cmVjdCB4PSIxNjUiIHk9Ijg1IiB3aWR0aD0iMzAiIGhlaWdodD0iMTAiIGZpbGw9IiM2Yjc2ODAiIHJ4PSI1Ii8+PHRleHQgeD0iNTAlIiB5PSIxODAiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TYW1wbGU6IEJpY2VwIEN1cmw8L3RleHQ+PC9zdmc+"
                }
            ];

            // Process sample data using the same flow as real API data
            processExerciseData(sampleExercises);
            
            console.log('üì¶ Sample data loaded successfully as ExerciseDB API fallback');
        }

        /**
         * Initialize the application when page loads
         * Sets up theme, event listeners, and starts data loading from ExerciseDB API
         */
        function initializeApp() {
            console.log('üöÄ Initializing FitExplorer application...');
            
            // Set up dark mode functionality
            initializeDarkMode();
            
            // Listen for system theme changes if user hasn't set preference
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (!localStorage.getItem('theme')) {
                    const darkModeIcon = document.getElementById('darkModeIcon');
                    if (event.matches) {
                        document.documentElement.classList.add('dark');
                        darkModeIcon.textContent = '‚òÄÔ∏è';
                    } else {
                        document.documentElement.classList.remove('dark');
                        darkModeIcon.textContent = 'üåô';
                    }
                }
            });
            
            // Start loading exercises from the ExerciseDB API
            console.log('üîå Starting to load exercises from ExerciseDB API...');
            loadExercises();
        }

        // Start the application when DOM is fully loaded
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        console.log('‚úÖ FitExplorer script loaded and ready to connect to ExerciseDB API');
    </script>
</body>
</html>
